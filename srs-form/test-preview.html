<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRS Preview Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #000; color: #00ff00; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #00ff00; }
        .error { color: #ff0000; }
        .success { color: #00ff00; }
        .info { color: #00ffff; }
        button { padding: 10px 20px; margin: 10px; background: #00ff00; color: #000; border: none; cursor: pointer; }
        button:hover { background: #00ffff; }
        pre { background: #111; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>SRS Preview Test Page</h1>
        
        <div class="test-section">
            <h2>URL Parameters Test</h2>
            <p>Current URL: <span id="currentUrl"></span></p>
            <p>Search Params: <span id="searchParams"></span></p>
            <p>Data Parameter: <span id="dataParam"></span></p>
            <p>Key Parameter: <span id="keyParam"></span></p>
        </div>

        <div class="test-section">
            <h2>Data Loading Test</h2>
            <p id="dataStatus">Checking...</p>
            <pre id="formData"></pre>
        </div>

        <div class="test-section">
            <h2>Test Actions</h2>
            <button onclick="testWithSampleData()">Test with Sample Data</button>
            <button onclick="testURLMethod()">Test URL Method</button>
            <button onclick="testLocalStorageMethod()">Test localStorage Method</button>
            <button onclick="goToMainForm()">Go to Main Form</button>
        </div>

        <div class="test-section">
            <h2>Console Logs</h2>
            <div id="consoleLogs"></div>
        </div>
    </div>

    <script>
        // Capture console logs
        const originalLog = console.log;
        const originalError = console.error;
        const logContainer = document.getElementById('consoleLogs');
        
        function addLog(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(div);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog(args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog(args.join(' '), 'error');
        };

        // Test functions
        function testWithSampleData() {
            console.log('Testing with sample data...');
            
            const sampleData = {
                projectName: 'Test Mobile App',
                clientName: 'Test Client',
                clientEmail: 'test@example.com',
                projectType: 'Mobile Application',
                projectDescription: 'A test mobile application',
                targetAudience: 'General users',
                primaryMarkets: 'Global',
                platforms: ['Android', 'iOS'],
                main_features: ['authentication', 'user_management', 'notifications'],
                projectTimeline: '3-6 months',
                budgetRange: '$5000-$10000',
                developmentPhase: 'Full Development',
                additionalNotes: 'Test data'
            };
            
            console.log('Sample data created:', sampleData);
            
            // Test URL method
            const encodedData = encodeURIComponent(JSON.stringify(sampleData));
            const testUrl = `srs-preview.html?data=${encodedData}`;
            console.log('Test URL:', testUrl);
            console.log('URL length:', testUrl.length);
            
            // Test localStorage method
            const dataKey = 'test_data_' + Date.now();
            localStorage.setItem(dataKey, JSON.stringify(sampleData));
            console.log('Data stored in localStorage with key:', dataKey);
            
            document.getElementById('formData').textContent = JSON.stringify(sampleData, null, 2);
            document.getElementById('dataStatus').innerHTML = '<span class="success">✓ Sample data loaded successfully</span>';
        }
        
        function testURLMethod() {
            console.log('Testing URL method...');
            const urlParams = new URLSearchParams(window.location.search);
            const encodedData = urlParams.get('data');
            
            if (encodedData) {
                try {
                    const data = JSON.parse(decodeURIComponent(encodedData));
                    console.log('URL data loaded successfully:', data);
                    document.getElementById('formData').textContent = JSON.stringify(data, null, 2);
                    document.getElementById('dataStatus').innerHTML = '<span class="success">✓ URL data loaded successfully</span>';
                } catch (error) {
                    console.error('Error parsing URL data:', error);
                    document.getElementById('dataStatus').innerHTML = '<span class="error">✗ Error parsing URL data: ' + error.message + '</span>';
                }
            } else {
                console.log('No data parameter found in URL');
                document.getElementById('dataStatus').innerHTML = '<span class="error">✗ No data parameter found in URL</span>';
            }
        }
        
        function testLocalStorageMethod() {
            console.log('Testing localStorage method...');
            const urlParams = new URLSearchParams(window.location.search);
            const dataKey = urlParams.get('key');
            
            if (dataKey) {
                const storedData = localStorage.getItem(dataKey);
                if (storedData) {
                    try {
                        const data = JSON.parse(storedData);
                        console.log('localStorage data loaded successfully:', data);
                        document.getElementById('formData').textContent = JSON.stringify(data, null, 2);
                        document.getElementById('dataStatus').innerHTML = '<span class="success">✓ localStorage data loaded successfully</span>';
                        localStorage.removeItem(dataKey);
                    } catch (error) {
                        console.error('Error parsing localStorage data:', error);
                        document.getElementById('dataStatus').innerHTML = '<span class="error">✗ Error parsing localStorage data: ' + error.message + '</span>';
                    }
                } else {
                    console.log('No data found in localStorage with key:', dataKey);
                    document.getElementById('dataStatus').innerHTML = '<span class="error">✗ No data found in localStorage</span>';
                }
            } else {
                console.log('No key parameter found in URL');
                document.getElementById('dataStatus').innerHTML = '<span class="error">✗ No key parameter found in URL</span>';
            }
        }
        
        function goToMainForm() {
            window.location.href = 'index.html';
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('SRS Preview Test Page loaded');
            
            // Display current URL info
            document.getElementById('currentUrl').textContent = window.location.href;
            document.getElementById('searchParams').textContent = window.location.search;
            
            const urlParams = new URLSearchParams(window.location.search);
            document.getElementById('dataParam').textContent = urlParams.get('data') ? 'Present' : 'Not found';
            document.getElementById('keyParam').textContent = urlParams.get('key') ? 'Present' : 'Not found';
            
            // Auto-test if data is present
            if (urlParams.get('data') || urlParams.get('key')) {
                console.log('Data parameters detected, running auto-test...');
                if (urlParams.get('data')) {
                    testURLMethod();
                } else if (urlParams.get('key')) {
                    testLocalStorageMethod();
                }
            } else {
                document.getElementById('dataStatus').innerHTML = '<span class="info">No data parameters found. Use test buttons above.</span>';
            }
        });
    </script>
</body>
</html>

